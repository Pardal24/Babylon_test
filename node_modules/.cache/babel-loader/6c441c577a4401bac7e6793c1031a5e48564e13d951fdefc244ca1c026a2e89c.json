{"ast":null,"code":"import { createContext, useState, useCallback, useEffect, useMemo, createElement, useContext } from 'react';\nvar OpenCvContext = createContext();\nvar OpenCvConsumer = OpenCvContext.Consumer,\n  Provider = OpenCvContext.Provider;\nvar scriptId = 'opencv-react';\nvar moduleConfig = {\n  wasmBinaryFile: 'opencv_js.wasm',\n  usingWasm: true\n};\nvar OpenCvProvider = function OpenCvProvider(_ref) {\n  var openCvPath = _ref.openCvPath,\n    children = _ref.children,\n    onLoad = _ref.onLoad;\n  var _React$useState = useState(false),\n    loaded = _React$useState[0],\n    setLoaded = _React$useState[1];\n  var handleOnLoad = useCallback(function () {\n    if (onLoad) {\n      onLoad(window.cv);\n    }\n    setLoaded(true);\n  }, []);\n  useEffect(function () {\n    if (document.getElementById(scriptId) || window.cv) {\n      setLoaded(true);\n      return;\n    }\n    moduleConfig.onRuntimeInitialized = handleOnLoad;\n    window.Module = moduleConfig;\n    var generateOpenCvScriptTag = function generateOpenCvScriptTag() {\n      var js = document.createElement('script');\n      js.id = scriptId;\n      js.src = openCvPath || 'https://docs.opencv.org/3.4.13/opencv.js';\n      js.nonce = true;\n      js.defer = true;\n      js.async = true;\n      return js;\n    };\n    document.body.appendChild(generateOpenCvScriptTag());\n  }, [openCvPath, handleOnLoad]);\n  var memoizedProviderValue = useMemo(function () {\n    return {\n      loaded: loaded,\n      cv: window.cv\n    };\n  }, [loaded]);\n  return /*#__PURE__*/createElement(Provider, {\n    value: memoizedProviderValue\n  }, children);\n};\nvar useOpenCv = function useOpenCv() {\n  return useContext(OpenCvContext);\n};\nexport { OpenCvConsumer, OpenCvContext, OpenCvProvider, useOpenCv };","map":{"version":3,"names":["OpenCvContext","createContext","OpenCvConsumer","Consumer","Provider","scriptId","moduleConfig","wasmBinaryFile","usingWasm","OpenCvProvider","_ref","openCvPath","children","onLoad","_React$useState","useState","loaded","setLoaded","handleOnLoad","useCallback","window","cv","useEffect","document","getElementById","onRuntimeInitialized","Module","generateOpenCvScriptTag","js","createElement","id","src","nonce","defer","async","body","appendChild","memoizedProviderValue","useMemo","value","useOpenCv","useContext"],"sources":["/home/fpardal/Desktop/cropper/node_modules/opencv-react/src/lib/OpenCvProvider.js","/home/fpardal/Desktop/cropper/node_modules/opencv-react/src/lib/useOpenCv.js"],"sourcesContent":["import * as React from 'react'\n\nconst OpenCvContext = React.createContext()\n\nconst { Consumer: OpenCvConsumer, Provider } = OpenCvContext\n\nexport { OpenCvConsumer, OpenCvContext }\n\nconst scriptId = 'opencv-react'\nconst moduleConfig = {\n  wasmBinaryFile: 'opencv_js.wasm',\n  usingWasm: true\n}\n\nexport const OpenCvProvider = ({ openCvPath, children, onLoad }) => {\n  const [loaded, setLoaded] = React.useState(false)\n\n  const handleOnLoad = React.useCallback(() => {\n    if (onLoad) {\n      onLoad(window.cv)\n    }\n    setLoaded(true)\n  }, [])\n\n  React.useEffect(() => {\n    if (document.getElementById(scriptId) || window.cv) {\n      setLoaded(true)\n      return\n    }\n\n    // https://docs.opencv.org/3.4/dc/de6/tutorial_js_nodejs.html\n    // https://medium.com/code-divoire/integrating-opencv-js-with-an-angular-application-20ae11c7e217\n    // https://stackoverflow.com/questions/56671436/cv-mat-is-not-a-constructor-opencv\n    moduleConfig.onRuntimeInitialized = handleOnLoad\n    window.Module = moduleConfig\n\n    const generateOpenCvScriptTag = () => {\n      const js = document.createElement('script')\n      js.id = scriptId\n      js.src = openCvPath || 'https://docs.opencv.org/3.4.13/opencv.js'\n\n      js.nonce = true\n      js.defer = true\n      js.async = true\n\n      return js\n    }\n\n    document.body.appendChild(generateOpenCvScriptTag())\n  }, [openCvPath, handleOnLoad])\n\n  const memoizedProviderValue = React.useMemo(\n    () => ({ loaded, cv: window.cv }),\n    [loaded]\n  )\n\n  return <Provider value={memoizedProviderValue}>{children}</Provider>\n}\n","import * as React from 'react'\nimport { OpenCvContext } from './OpenCvProvider'\n\nexport const useOpenCv = () => React.useContext(OpenCvContext)\n"],"mappings":";IAEMA,aAAa,GAAGC,aAAA;IAEJC,cAAA,GAA6BF,aAAA,CAAvCG,QAAA;EAA0BC,QAAA,GAAaJ,aAAA,CAAbI,QAAA;AAIlC,IAAMC,QAAQ,GAAG,cAAjB;AACA,IAAMC,YAAY,GAAG;EACnBC,cAAc,EAAE,gBADG;EAEnBC,SAAS,EAAE;AAFQ,CAArB;IAKaC,cAAc,GAAG,SAAjBA,cAAiBA,CAAAC,IAAA,EAAsC;EAAA,IAAnCC,UAAmC,GAAAD,IAAA,CAAnCC,UAAmC;IAAvBC,QAAuB,GAAAF,IAAA,CAAvBE,QAAuB;IAAbC,MAAa,GAAAH,IAAA,CAAbG,MAAa;EAAA,IAAAC,eAAA,GACtCC,QAAA,CAAe,KAAf,CADsC;IAC3DC,MAD2D,GAAAF,eAAA;IACnDG,SADmD,GAAAH,eAAA;EAGlE,IAAMI,YAAY,GAAGC,WAAA,CAAkB,YAAM;IAC3C,IAAIN,MAAJ,EAAY;MACVA,MAAM,CAACO,MAAM,CAACC,EAAR,CAAN;IACD;IACDJ,SAAS,CAAC,IAAD,CAAT;EACD,CALoB,EAKlB,EALkB,CAArB;EAOAK,SAAA,CAAgB,YAAM;IACpB,IAAIC,QAAQ,CAACC,cAAT,CAAwBnB,QAAxB,KAAqCe,MAAM,CAACC,EAAhD,EAAoD;MAClDJ,SAAS,CAAC,IAAD,CAAT;MACA;IACD;IAKDX,YAAY,CAACmB,oBAAb,GAAoCP,YAApC;IACAE,MAAM,CAACM,MAAP,GAAgBpB,YAAhB;IAEA,IAAMqB,uBAAuB,GAAG,SAA1BA,uBAA0BA,CAAA,EAAM;MACpC,IAAMC,EAAE,GAAGL,QAAQ,CAACM,aAAT,CAAuB,QAAvB,CAAX;MACAD,EAAE,CAACE,EAAH,GAAQzB,QAAR;MACAuB,EAAE,CAACG,GAAH,GAASpB,UAAU,IAAI,0CAAvB;MAEAiB,EAAE,CAACI,KAAH,GAAW,IAAX;MACAJ,EAAE,CAACK,KAAH,GAAW,IAAX;MACAL,EAAE,CAACM,KAAH,GAAW,IAAX;MAEA,OAAON,EAAP;IACD,CAVD;IAYAL,QAAQ,CAACY,IAAT,CAAcC,WAAd,CAA0BT,uBAAuB,EAAjD;EACD,CAzBD,EAyBG,CAAChB,UAAD,EAAaO,YAAb,CAzBH;EA2BA,IAAMmB,qBAAqB,GAAGC,OAAA,CAC5B;IAAA,OAAO;MAAEtB,MAAM,EAANA,MAAF;MAAUK,EAAE,EAAED,MAAM,CAACC;IAArB,CAAP;EAAA,CAD4B,EAE5B,CAACL,MAAD,CAF4B,CAA9B;EAKA,oBAAOa,aAAA,CAACzB,QAAD;IAAUmC,KAAK,EAAEF;EAAjB,GAAyCzB,QAAzC,CAAP;AACD;ICtDY4B,SAAS,GAAG,SAAZA,SAAYA,CAAA;EAAA,OAAMC,UAAA,CAAiBzC,aAAjB,CAAN;AAAA,CAAlB"},"metadata":{},"sourceType":"module","externalDependencies":[]}